<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Content Management | Admin Dashboard</title>
  <link rel="icon" type="image/png" href="https://cdn.grapesjs.com/workspaces/cmjdh0oo603xm12grpuiruk7p/assets/f6b95b3d-49d1-4e77-b952-49ed80c4befa__image-9-14-1404-ap-at-8.42-pm.png">
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <!-- TinyMCE Rich Text Editor -->
  <script src="https://cdn.tiny.cloud/1/no-api-key/tinymce/6/tinymce.min.js" referrerpolicy="origin"></script>
  
  <!-- Auth & Config Scripts -->
  <script src="../js/config.js"></script>
  <script src="../js/auth.js"></script>
  
  <style>
    * { font-family: 'Inter', sans-serif; }
    .gradient-text { background: linear-gradient(135deg, #8b5cf6 0%, #ec4899 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    .tab-active { background: linear-gradient(135deg, #8b5cf6 0%, #ec4899 100%); }
    .content-card { transition: all 0.3s ease; }
    .content-card:hover { transform: translateY(-2px); box-shadow: 0 10px 30px rgba(139, 92, 246, 0.2); }
  </style>
</head>
<body class="bg-slate-950 text-white">
  <!-- Top Navigation -->
  <nav class="fixed w-full z-50 bg-slate-900/95 backdrop-blur-xl border-b border-slate-800">
    <div class="max-w-7xl mx-auto px-6 py-4">
      <div class="flex items-center justify-between">
        <div class="flex items-center gap-8">
          <a href="admin-dashboard.html" class="flex items-center gap-3">
            <div class="w-10 h-10 bg-gradient-to-br from-purple-500 to-pink-600 rounded-xl flex items-center justify-center">
              <i class="fas fa-shield-alt text-white"></i>
            </div>
            <span class="text-xl font-black">Admin <span class="gradient-text">Portal</span></span>
          </a>
          <div class="hidden md:flex items-center gap-6">
            <a href="admin-dashboard.html" class="text-gray-400 hover:text-white transition-colors">
              <i class="fas fa-chart-line mr-2"></i>Dashboard
            </a>
            <a href="content-management.html" class="text-purple-500 font-semibold">
              <i class="fas fa-edit mr-2"></i>Content
            </a>
            <a href="user-management.html" class="text-gray-400 hover:text-white transition-colors">
              <i class="fas fa-users mr-2"></i>Users
            </a>
          </div>
        </div>
        <div class="flex items-center gap-4">
          <span class="text-gray-400 text-sm" id="adminName">Admin</span>
          <button onclick="logout()" class="bg-slate-800 hover:bg-slate-700 px-4 py-2 rounded-lg transition-colors">
            <i class="fas fa-sign-out-alt mr-2"></i>Logout
          </button>
        </div>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <div class="pt-24 pb-12 px-6">
    <div class="max-w-7xl mx-auto">
      <!-- Header -->
      <div class="mb-8">
        <h1 class="text-4xl font-black mb-2">Content Management</h1>
        <p class="text-gray-400">Create and manage products, articles, and news</p>
      </div>

      <!-- Tabs -->
      <div class="flex gap-4 mb-8 overflow-x-auto">
        <button onclick="switchTab('products')" id="tab-products" class="tab-active px-6 py-3 rounded-xl font-semibold whitespace-nowrap transition-all">
          <i class="fas fa-box mr-2"></i>Products
        </button>
        <button onclick="switchTab('articles')" id="tab-articles" class="bg-slate-900 hover:bg-slate-800 px-6 py-3 rounded-xl font-semibold whitespace-nowrap transition-all">
          <i class="fas fa-newspaper mr-2"></i>Articles & News
        </button>
        <button onclick="switchTab('media')" id="tab-media" class="bg-slate-900 hover:bg-slate-800 px-6 py-3 rounded-xl font-semibold whitespace-nowrap transition-all">
          <i class="fas fa-images mr-2"></i>Media Library
        </button>
      </div>

      <!-- Products Tab -->
      <div id="content-products" class="tab-content">
        <!-- Action Bar -->
        <div class="flex items-center justify-between mb-6">
          <div class="flex items-center gap-4">
            <div class="relative">
              <input 
                type="text" 
                id="searchProducts"
                placeholder="Search products..."
                class="bg-slate-900 border border-slate-800 rounded-xl px-4 py-2 pl-10 text-white focus:outline-none focus:border-purple-500"
              >
              <i class="fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
            </div>
            <select class="bg-slate-900 border border-slate-800 rounded-xl px-4 py-2 text-white focus:outline-none focus:border-purple-500">
              <option>All Categories</option>
              <option>Calculators</option>
              <option>Databases</option>
              <option>Tools</option>
              <option>Reports</option>
            </select>
          </div>
          <button onclick="openProductModal()" class="bg-gradient-to-r from-purple-500 to-pink-600 px-6 py-2 rounded-xl font-semibold hover:shadow-xl transition-all">
            <i class="fas fa-plus mr-2"></i>Add Product
          </button>
        </div>

        <!-- Products Grid -->
        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6" id="productsGrid">
          <!-- Products will be loaded here -->
        </div>
      </div>

      <!-- Articles Tab -->
      <div id="content-articles" class="tab-content hidden">
        <!-- Action Bar -->
        <div class="flex items-center justify-between mb-6">
          <div class="flex items-center gap-4">
            <div class="relative">
              <input 
                type="text" 
                id="searchArticles"
                placeholder="Search articles..."
                class="bg-slate-900 border border-slate-800 rounded-xl px-4 py-2 pl-10 text-white focus:outline-none focus:border-purple-500"
              >
              <i class="fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
            </div>
            <select class="bg-slate-900 border border-slate-800 rounded-xl px-4 py-2 text-white focus:outline-none focus:border-purple-500">
              <option>All Status</option>
              <option>Published</option>
              <option>Draft</option>
              <option>Scheduled</option>
            </select>
          </div>
          <button onclick="openArticleModal()" class="bg-gradient-to-r from-purple-500 to-pink-600 px-6 py-2 rounded-xl font-semibold hover:shadow-xl transition-all">
            <i class="fas fa-plus mr-2"></i>Add Article
          </button>
        </div>

        <!-- Articles List -->
        <div class="space-y-4" id="articlesGrid">
          <!-- Articles will be loaded here -->
        </div>
      </div>

      <!-- Media Library Tab -->
      <div id="content-media" class="tab-content hidden">
        <!-- Action Bar -->
        <div class="flex items-center justify-between mb-6">
          <div class="flex items-center gap-4">
            <div class="relative">
              <input 
                type="text" 
                id="searchMedia"
                placeholder="Search media..."
                class="bg-slate-900 border border-slate-800 rounded-xl px-4 py-2 pl-10 text-white focus:outline-none focus:border-purple-500"
              >
              <i class="fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"></i>
            </div>
            <select class="bg-slate-900 border border-slate-800 rounded-xl px-4 py-2 text-white focus:outline-none focus:border-purple-500">
              <option>All Types</option>
              <option>Images</option>
              <option>Videos</option>
              <option>Documents</option>
            </select>
          </div>
          <button onclick="openMediaUpload()" class="bg-gradient-to-r from-purple-500 to-pink-600 px-6 py-2 rounded-xl font-semibold hover:shadow-xl transition-all">
            <i class="fas fa-upload mr-2"></i>Upload Media
          </button>
        </div>

        <!-- Media Grid -->
        <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4" id="mediaGrid">
          <!-- Media will be loaded here -->
        </div>
      </div>
    </div>
  </div>

  <!-- Product Modal -->
  <div id="productModal" class="hidden fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-6 overflow-y-auto">
    <div class="bg-slate-900 rounded-2xl border border-slate-800 w-full max-w-3xl my-8">
      <div class="flex items-center justify-between p-6 border-b border-slate-800">
        <h2 class="text-2xl font-bold">
          <i class="fas fa-box text-purple-500 mr-2"></i>
          <span id="productModalTitle">Add New Product</span>
        </h2>
        <button onclick="closeProductModal()" class="text-gray-400 hover:text-white transition-colors">
          <i class="fas fa-times text-2xl"></i>
        </button>
      </div>
      
      <form id="productForm" onsubmit="saveProduct(event)" class="p-6 space-y-6">
        <input type="hidden" id="productId">
        
        <!-- Product Name -->
        <div>
          <label class="block text-sm font-semibold mb-2">
            <i class="fas fa-tag text-purple-500 mr-2"></i>Product Name
          </label>
          <input 
            type="text" 
            id="productName"
            required
            class="w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-purple-500"
            placeholder="e.g., Advanced Cost Calculator"
          >
        </div>

        <!-- Category & Type -->
        <div class="grid md:grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-semibold mb-2">
              <i class="fas fa-folder text-purple-500 mr-2"></i>Category
            </label>
            <select 
              id="productCategory"
              required
              class="w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-purple-500"
            >
              <option value="">Select Category</option>
              <option value="calculator">Calculator</option>
              <option value="database">Database</option>
              <option value="tool">Tool</option>
              <option value="report">Report</option>
              <option value="hub">Hub</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-semibold mb-2">
              <i class="fas fa-layer-group text-purple-500 mr-2"></i>Product Type
            </label>
            <select 
              id="productType"
              required
              class="w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-purple-500"
            >
              <option value="">Select Type</option>
              <option value="free">Free</option>
              <option value="premium">Premium</option>
              <option value="enterprise">Enterprise</option>
            </select>
          </div>
        </div>

        <!-- Description -->
        <div>
          <label class="block text-sm font-semibold mb-2">
            <i class="fas fa-align-left text-purple-500 mr-2"></i>Short Description
          </label>
          <textarea 
            id="productDescription"
            required
            rows="3"
            class="w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-purple-500"
            placeholder="Brief description of the product..."
          ></textarea>
        </div>

        <!-- Features -->
        <div>
          <label class="block text-sm font-semibold mb-2">
            <i class="fas fa-list text-purple-500 mr-2"></i>Key Features (one per line)
          </label>
          <textarea 
            id="productFeatures"
            rows="4"
            class="w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-purple-500"
            placeholder="Feature 1&#10;Feature 2&#10;Feature 3"
          ></textarea>
        </div>

        <!-- Pricing -->
        <div class="grid md:grid-cols-3 gap-4">
          <div>
            <label class="block text-sm font-semibold mb-2">
              <i class="fas fa-dollar-sign text-purple-500 mr-2"></i>Price
            </label>
            <input 
              type="number" 
              id="productPrice"
              step="0.01"
              class="w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-purple-500"
              placeholder="0.00"
            >
          </div>
          <div>
            <label class="block text-sm font-semibold mb-2">
              <i class="fas fa-percentage text-purple-500 mr-2"></i>Discount %
            </label>
            <input 
              type="number" 
              id="productDiscount"
              min="0"
              max="100"
              class="w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-purple-500"
              placeholder="0"
            >
          </div>
          <div>
            <label class="block text-sm font-semibold mb-2">
              <i class="fas fa-clock text-purple-500 mr-2"></i>Billing Period
            </label>
            <select 
              id="productPeriod"
              class="w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-purple-500"
            >
              <option value="one-time">One-time</option>
              <option value="monthly">Monthly</option>
              <option value="yearly">Yearly</option>
            </select>
          </div>
        </div>

        <!-- Image URL -->
        <div>
          <label class="block text-sm font-semibold mb-2">
            <i class="fas fa-image text-purple-500 mr-2"></i>Product Image URL
          </label>
          <input 
            type="url" 
            id="productImage"
            class="w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-purple-500"
            placeholder="https://example.com/image.jpg"
          >
        </div>

        <!-- Product URL -->
        <div>
          <label class="block text-sm font-semibold mb-2">
            <i class="fas fa-link text-purple-500 mr-2"></i>Product Page URL
          </label>
          <input 
            type="text" 
            id="productUrl"
            class="w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-purple-500"
            placeholder="/products/product-name.html"
          >
        </div>

        <!-- Status -->
        <div>
          <label class="flex items-center cursor-pointer">
            <input type="checkbox" id="productActive" checked class="w-5 h-5 rounded border-slate-700 text-purple-500 focus:ring-purple-500">
            <span class="ml-3 font-semibold">
              <i class="fas fa-check-circle text-green-500 mr-2"></i>Active (visible to users)
            </span>
          </label>
        </div>

        <!-- Action Buttons -->
        <div class="flex gap-4 pt-4 border-t border-slate-800">
          <button 
            type="button" 
            onclick="closeProductModal()"
            class="flex-1 bg-slate-800 hover:bg-slate-700 py-3 rounded-xl font-semibold transition-all"
          >
            Cancel
          </button>
          <button 
            type="submit"
            class="flex-1 bg-gradient-to-r from-purple-500 to-pink-600 hover:from-purple-600 hover:to-pink-700 py-3 rounded-xl font-semibold transition-all"
          >
            <i class="fas fa-save mr-2"></i>Save Product
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Article Modal -->
  <div id="articleModal" class="hidden fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-6 overflow-y-auto">
    <div class="bg-slate-900 rounded-2xl border border-slate-800 w-full max-w-4xl my-8">
      <div class="flex items-center justify-between p-6 border-b border-slate-800">
        <h2 class="text-2xl font-bold">
          <i class="fas fa-newspaper text-purple-500 mr-2"></i>
          <span id="articleModalTitle">Add New Article</span>
        </h2>
        <button onclick="closeArticleModal()" class="text-gray-400 hover:text-white transition-colors">
          <i class="fas fa-times text-2xl"></i>
        </button>
      </div>
      
      <form id="articleForm" onsubmit="saveArticle(event)" class="p-6 space-y-6">
        <input type="hidden" id="articleId">
        
        <!-- Article Title -->
        <div>
          <label class="block text-sm font-semibold mb-2">
            <i class="fas fa-heading text-purple-500 mr-2"></i>Article Title
          </label>
          <input 
            type="text" 
            id="articleTitle"
            required
            class="w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-purple-500"
            placeholder="Enter article title..."
          >
        </div>

        <!-- Category & Author -->
        <div class="grid md:grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-semibold mb-2">
              <i class="fas fa-folder text-purple-500 mr-2"></i>Category
            </label>
            <select 
              id="articleCategory"
              required
              class="w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-purple-500"
            >
              <option value="">Select Category</option>
              <option value="news">News</option>
              <option value="tutorial">Tutorial</option>
              <option value="case-study">Case Study</option>
              <option value="industry-insights">Industry Insights</option>
              <option value="product-updates">Product Updates</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-semibold mb-2">
              <i class="fas fa-user text-purple-500 mr-2"></i>Author
            </label>
            <input 
              type="text" 
              id="articleAuthor"
              required
              class="w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-purple-500"
              placeholder="Author name"
            >
          </div>
        </div>

        <!-- Excerpt -->
        <div>
          <label class="block text-sm font-semibold mb-2">
            <i class="fas fa-quote-left text-purple-500 mr-2"></i>Excerpt
          </label>
          <textarea 
            id="articleExcerpt"
            required
            rows="2"
            class="w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-purple-500"
            placeholder="Brief summary of the article..."
          ></textarea>
        </div>

        <!-- Content Editor -->
        <div>
          <label class="block text-sm font-semibold mb-2">
            <i class="fas fa-file-alt text-purple-500 mr-2"></i>Article Content
          </label>
          <textarea 
            id="articleContent"
            rows="12"
            class="w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-purple-500"
            placeholder="Write your article content here..."
          ></textarea>
        </div>

        <!-- Featured Image -->
        <div>
          <label class="block text-sm font-semibold mb-2">
            <i class="fas fa-image text-purple-500 mr-2"></i>Featured Image URL
          </label>
          <input 
            type="url" 
            id="articleImage"
            class="w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-purple-500"
            placeholder="https://example.com/image.jpg"
          >
        </div>

        <!-- Tags -->
        <div>
          <label class="block text-sm font-semibold mb-2">
            <i class="fas fa-tags text-purple-500 mr-2"></i>Tags (comma separated)
          </label>
          <input 
            type="text" 
            id="articleTags"
            class="w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-purple-500"
            placeholder="mining, cost, optimization"
          >
        </div>

        <!-- Publishing Options -->
        <div class="grid md:grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-semibold mb-2">
              <i class="fas fa-calendar text-purple-500 mr-2"></i>Publish Date
            </label>
            <input 
              type="datetime-local" 
              id="articlePublishDate"
              class="w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-purple-500"
            >
          </div>
          <div>
            <label class="block text-sm font-semibold mb-2">
              <i class="fas fa-toggle-on text-purple-500 mr-2"></i>Status
            </label>
            <select 
              id="articleStatus"
              class="w-full bg-slate-950 border border-slate-800 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-purple-500"
            >
              <option value="draft">Draft</option>
              <option value="published">Published</option>
              <option value="scheduled">Scheduled</option>
            </select>
          </div>
        </div>

        <!-- Featured Toggle -->
        <div>
          <label class="flex items-center cursor-pointer">
            <input type="checkbox" id="articleFeatured" class="w-5 h-5 rounded border-slate-700 text-purple-500 focus:ring-purple-500">
            <span class="ml-3 font-semibold">
              <i class="fas fa-star text-amber-500 mr-2"></i>Featured Article
            </span>
          </label>
        </div>

        <!-- Action Buttons -->
        <div class="flex gap-4 pt-4 border-t border-slate-800">
          <button 
            type="button" 
            onclick="closeArticleModal()"
            class="flex-1 bg-slate-800 hover:bg-slate-700 py-3 rounded-xl font-semibold transition-all"
          >
            Cancel
          </button>
          <button 
            type="button"
            onclick="saveArticle(event, 'draft')"
            class="flex-1 bg-slate-700 hover:bg-slate-600 py-3 rounded-xl font-semibold transition-all"
          >
            <i class="fas fa-save mr-2"></i>Save Draft
          </button>
          <button 
            type="submit"
            class="flex-1 bg-gradient-to-r from-purple-500 to-pink-600 hover:from-purple-600 hover:to-pink-700 py-3 rounded-xl font-semibold transition-all"
          >
            <i class="fas fa-paper-plane mr-2"></i>Publish
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Media Upload Modal -->
  <div id="mediaModal" class="hidden fixed inset-0 bg-black/80 flex items-center justify-center z-50 p-6">
    <div class="bg-slate-900 rounded-2xl border border-slate-800 w-full max-w-2xl">
      <div class="flex items-center justify-between p-6 border-b border-slate-800">
        <h2 class="text-2xl font-bold">
          <i class="fas fa-upload text-purple-500 mr-2"></i>Upload Media
        </h2>
        <button onclick="closeMediaModal()" class="text-gray-400 hover:text-white transition-colors">
          <i class="fas fa-times text-2xl"></i>
        </button>
      </div>
      
      <div class="p-6">
        <!-- Drag & Drop Area -->
        <div class="border-2 border-dashed border-slate-700 rounded-xl p-12 text-center hover:border-purple-500 transition-colors cursor-pointer" onclick="document.getElementById('fileInput').click()">
          <i class="fas fa-cloud-upload-alt text-6xl text-purple-500 mb-4"></i>
          <p class="text-xl font-semibold mb-2">Drop files here or click to upload</p>
          <p class="text-gray-400 text-sm">Supports: JPG, PNG, GIF, PDF, MP4 (Max 10MB)</p>
          <input type="file" id="fileInput" multiple class="hidden" onchange="handleFileUpload(event)">
        </div>

        <!-- Upload Progress -->
        <div id="uploadProgress" class="hidden mt-6">
          <div class="bg-slate-950 rounded-xl p-4">
            <div class="flex items-center justify-between mb-2">
              <span class="text-sm font-semibold">Uploading...</span>
              <span class="text-sm text-gray-400" id="uploadPercent">0%</span>
            </div>
            <div class="w-full bg-slate-800 rounded-full h-2">
              <div id="uploadBar" class="bg-gradient-to-r from-purple-500 to-pink-600 h-2 rounded-full transition-all" style="width: 0%"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="../js/admin-content.js"></script>
  <script>
    // Require admin authentication
    requireAdmin();

    // Initialize on page load
    document.addEventListener('DOMContentLoaded', function() {
      const user = getCurrentUser();
      if (user) {
        document.getElementById('adminName').textContent = user.name;
      }
      
      // Load initial data
      loadProducts();
      loadArticles();
      loadMedia();
      
      // Set current date for article publish date
      const now = new Date();
      now.setMinutes(now.getMinutes() - now.getTimezoneOffset());
      document.getElementById('articlePublishDate').value = now.toISOString().slice(0, 16);
    });

    // Tab switching
    function switchTab(tab) {
      // Hide all tabs
      document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
      document.querySelectorAll('[id^="tab-"]').forEach(el => {
        el.classList.remove('tab-active');
        el.classList.add('bg-slate-900', 'hover:bg-slate-800');
      });
      
      // Show selected tab
      document.getElementById('content-' + tab).classList.remove('hidden');
      document.getElementById('tab-' + tab).classList.add('tab-active');
      document.getElementById('tab-' + tab).classList.remove('bg-slate-900', 'hover:bg-slate-800');
    }
  </script>
</body>
</html>
