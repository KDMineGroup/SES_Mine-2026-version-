<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Portal | SES_MINE - Content Publishing System</title>
  <link rel="icon" type="image/png" href="https://cdn.grapesjs.com/workspaces/cmjdh0oo603xm12grpuiruk7p/assets/f6b95b3d-49d1-4e77-b952-49ed80c4befa__image-9-14-1404-ap-at-8.42-pm.png">
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
  <style>
    * { 
      font-family: 'Inter', sans-serif;
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
      min-height: 100vh;
    }
    .gradient-text { 
      background: linear-gradient(135deg, #06b6d4 0%, #3b82f6 50%, #8b5cf6 100%); 
      -webkit-background-clip: text; 
      -webkit-text-fill-color: transparent; 
    }
    .glass {
      background: rgba(15, 23, 42, 0.7);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .fade-in { animation: fadeIn 0.5s ease-out; }
    .card-hover {
      transition: all 0.3s ease;
    }
    .card-hover:hover {
      transform: translateY(-5px);
      box-shadow: 0 20px 40px rgba(6, 182, 212, 0.3);
    }
    .modal {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.8);
      z-index: 100;
      align-items: center;
      justify-content: center;
      padding: 1rem;
      overflow-y: auto;
    }
    .modal.active {
      display: flex;
    }
    .tab-button {
      transition: all 0.3s ease;
    }
    .tab-button.active {
      background: linear-gradient(135deg, #06b6d4 0%, #3b82f6 100%);
    }
    .badge-new {
      animation: pulse 2s infinite;
    }
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
    .notification {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 1000;
      padding: 1rem 1.5rem;
      border-radius: 0.75rem;
      font-weight: 600;
      animation: slideIn 0.3s ease-out;
    }
    @keyframes slideIn {
      from { transform: translateX(400px); }
      to { transform: translateX(0); }
    }
    .status-pending {
      border: 2px solid rgba(251, 191, 36, 0.5);
    }
  </style>
</head>
<body class="text-white">
  <!-- Login Screen -->
  <div id="loginScreen" class="min-h-screen flex items-center justify-center p-4">
    <div class="w-full max-w-md">
      <div class="text-center mb-8 fade-in">
        <img src="https://cdn.grapesjs.com/workspaces/cmjdh0oo603xm12grpuiruk7p/assets/f6b95b3d-49d1-4e77-b952-49ed80c4befa__image-9-14-1404-ap-at-8.42-pm.png" alt="SES_MINE" class="h-16 mx-auto mb-4">
        <h1 class="text-3xl font-black mb-2">Admin <span class="gradient-text">Portal</span></h1>
        <p class="text-gray-400">Content Publishing System</p>
      </div>

      <div class="glass rounded-3xl p-8 shadow-2xl fade-in" style="animation-delay: 0.1s">
        <form id="loginForm" class="space-y-6">
          <div>
            <label class="block text-sm font-semibold mb-2">
              <i class="fas fa-envelope text-cyan-400 mr-2"></i>Email
            </label>
            <input 
              type="email" 
              id="loginEmail"
              value="admin@sesmine.com"
              required
              class="w-full bg-slate-800/50 border border-slate-700 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-cyan-500 transition-all"
            >
          </div>

          <div>
            <label class="block text-sm font-semibold mb-2">
              <i class="fas fa-lock text-cyan-400 mr-2"></i>Password
            </label>
            <div class="relative">
              <input 
                type="password" 
                id="loginPassword"
                value="admin123"
                required
                class="w-full bg-slate-800/50 border border-slate-700 rounded-xl px-4 py-3 pr-12 text-white focus:outline-none focus:border-cyan-500 transition-all"
              >
              <button type="button" onclick="togglePasswordVisibility()" class="absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 hover:text-cyan-400">
                <i class="fas fa-eye" id="toggleIcon"></i>
              </button>
            </div>
          </div>

          <div id="loginError" class="hidden bg-red-500/20 border border-red-500 rounded-xl p-3 text-sm text-red-400">
            <i class="fas fa-exclamation-circle mr-2"></i>
            <span id="errorMessage"></span>
          </div>

          <button 
            type="submit"
            class="w-full bg-gradient-to-r from-cyan-500 via-blue-500 to-purple-600 hover:from-cyan-600 hover:via-blue-600 hover:to-purple-700 text-white font-bold py-4 rounded-xl transition-all transform hover:scale-105"
          >
            <i class="fas fa-sign-in-alt mr-2"></i>
            <span id="loginButtonText">Sign In</span>
          </button>
        </form>

        <div class="mt-6 p-4 bg-cyan-500/10 border border-cyan-500/30 rounded-xl">
          <p class="text-sm font-semibold mb-2 text-cyan-400">
            <i class="fas fa-info-circle mr-2"></i>Demo Credentials
          </p>
          <div class="text-xs text-gray-400 space-y-1">
            <p><strong>Email:</strong> admin@sesmine.com</p>
            <p><strong>Password:</strong> admin123</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Dashboard Screen -->
  <div id="dashboardScreen" class="hidden">
    <!-- Navigation -->
    <nav class="fixed w-full z-50 glass border-b border-slate-800">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 py-4">
        <div class="flex items-center justify-between">
          <div class="flex items-center gap-8">
            <img src="https://cdn.grapesjs.com/workspaces/cmjdh0oo603xm12grpuiruk7p/assets/f6b95b3d-49d1-4e77-b952-49ed80c4befa__image-9-14-1404-ap-at-8.42-pm.png" alt="SES_MINE" class="h-12">
            <div class="hidden md:flex items-center gap-6">
              <a href="#" onclick="showSection('dashboard')" id="nav-dashboard" class="nav-link text-cyan-400 font-semibold">
                <i class="fas fa-chart-line mr-2"></i>Dashboard
              </a>
              <a href="#" onclick="showSection('content')" id="nav-content" class="nav-link text-gray-400 hover:text-white transition-colors relative">
                <i class="fas fa-newspaper mr-2"></i>Content
                <span id="contentBadge" class="absolute -top-2 -right-2 w-5 h-5 bg-amber-500 rounded-full text-xs flex items-center justify-center badge-new" style="display:none;">0</span>
              </a>
              <a href="#" onclick="showSection('approval')" id="nav-approval" class="nav-link text-gray-400 hover:text-white transition-colors relative">
                <i class="fas fa-check-circle mr-2"></i>Approval Queue
                <span id="approvalBadge" class="absolute -top-2 -right-2 w-5 h-5 bg-red-500 rounded-full text-xs flex items-center justify-center badge-new" style="display:none;">0</span>
              </a>
              <a href="#" onclick="showSection('published')" id="nav-published" class="nav-link text-gray-400 hover:text-white transition-colors">
                <i class="fas fa-globe mr-2"></i>Published
              </a>
            </div>
          </div>
          <div class="flex items-center gap-4">
            <div class="hidden sm:flex items-center gap-3 glass px-4 py-2 rounded-lg">
              <img src="https://i.pravatar.cc/100?img=5" alt="Admin" class="w-8 h-8 rounded-full border-2 border-cyan-500">
              <div>
                <div class="text-sm font-semibold" id="navAdminName">Admin</div>
                <div class="text-xs text-gray-400">Administrator</div>
              </div>
            </div>
            <button onclick="handleLogout()" class="bg-red-500/20 hover:bg-red-500/30 border border-red-500/50 text-red-400 px-4 py-2 rounded-lg transition-all font-semibold">
              <i class="fas fa-sign-out-alt mr-2"></i>Logout
            </button>
          </div>
        </div>
      </div>
    </nav>

    <!-- Main Dashboard -->
    <div id="dashboardContent" class="pt-24 pb-12 px-4 sm:px-6">
      <div class="max-w-7xl mx-auto">
        <div class="mb-8 fade-in">
          <h1 class="text-4xl font-black mb-2">
            Content Publishing <span class="gradient-text">Dashboard</span> ðŸ“°
          </h1>
          <p class="text-gray-400">Manage and approve content for News & Resources pages</p>
          <p class="text-sm text-gray-500 mt-2">
            <i class="fas fa-clock mr-2"></i>
            <span id="currentTime"></span>
          </p>
        </div>

        <!-- Stats -->
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-6 mb-8">
          <div class="card-hover glass rounded-2xl p-6 fade-in cursor-pointer" onclick="showSection('content')">
            <div class="w-14 h-14 bg-purple-500/20 rounded-xl flex items-center justify-center mb-4">
              <i class="fas fa-file-alt text-purple-400 text-2xl"></i>
            </div>
            <div class="text-3xl font-black mb-1" id="statTotal">0</div>
            <div class="text-gray-400 text-sm">Total Content</div>
          </div>

          <div class="card-hover glass rounded-2xl p-6 fade-in cursor-pointer" onclick="showSection('content')" style="animation-delay: 0.1s">
            <div class="w-14 h-14 bg-amber-500/20 rounded-xl flex items-center justify-center mb-4">
              <i class="fas fa-edit text-amber-400 text-2xl"></i>
            </div>
            <div class="text-3xl font-black mb-1" id="statDraft">0</div>
            <div class="text-gray-400 text-sm">Drafts</div>
          </div>

          <div class="card-hover glass rounded-2xl p-6 fade-in cursor-pointer" onclick="showSection('approval')" style="animation-delay: 0.2s">
            <div class="w-14 h-14 bg-orange-500/20 rounded-xl flex items-center justify-center mb-4">
              <i class="fas fa-clock text-orange-400 text-2xl"></i>
            </div>
            <div class="text-3xl font-black mb-1" id="statPending">0</div>
            <div class="text-gray-400 text-sm">Pending Approval</div>
          </div>

          <div class="card-hover glass rounded-2xl p-6 fade-in cursor-pointer" onclick="showSection('published')" style="animation-delay: 0.3s">
            <div class="w-14 h-14 bg-green-500/20 rounded-xl flex items-center justify-center mb-4">
              <i class="fas fa-check-circle text-green-400 text-2xl"></i>
            </div>
            <div class="text-3xl font-black mb-1" id="statPublished">0</div>
            <div class="text-gray-400 text-sm">Published</div>
          </div>

          <div class="card-hover glass rounded-2xl p-6 fade-in" style="animation-delay: 0.4s">
            <div class="w-14 h-14 bg-cyan-500/20 rounded-xl flex items-center justify-center mb-4">
              <i class="fas fa-eye text-cyan-400 text-2xl"></i>
            </div>
            <div class="text-3xl font-black mb-1" id="statViews">0</div>
            <div class="text-gray-400 text-sm">Total Views</div>
          </div>
        </div>

        <!-- Charts -->
        <div class="grid lg:grid-cols-2 gap-6 mb-8">
          <div class="glass rounded-2xl p-6 fade-in">
            <h3 class="text-xl font-bold mb-6">
              <i class="fas fa-chart-line text-cyan-400 mr-2"></i>Publishing Activity
            </h3>
            <div style="position: relative; height: 300px;">
              <canvas id="activityChart"></canvas>
            </div>
          </div>

          <div class="glass rounded-2xl p-6 fade-in" style="animation-delay: 0.1s">
            <h3 class="text-xl font-bold mb-6">
              <i class="fas fa-chart-pie text-purple-400 mr-2"></i>Content Status Distribution
            </h3>
            <div style="position: relative; height: 300px;">
              <canvas id="statusChart"></canvas>
            </div>
          </div>
        </div>

        <!-- Recent Activity -->
        <div class="glass rounded-2xl p-6 fade-in">
          <div class="flex items-center justify-between mb-6">
            <h3 class="text-xl font-bold">
              <i class="fas fa-history text-purple-400 mr-2"></i>Recent Activity
            </h3>
            <button onclick="loadRecentActivity()" class="text-cyan-400 hover:text-cyan-300 text-sm">
              <i class="fas fa-sync-alt mr-2"></i>Refresh
            </button>
          </div>
          <div class="space-y-3" id="activityList"></div>
        </div>
      </div>
    </div>

    <!-- Content Management Section -->
    <div id="contentContent" class="hidden pt-24 pb-12 px-4 sm:px-6">
      <div class="max-w-7xl mx-auto">
        <div class="flex items-center justify-between mb-8">
          <h1 class="text-4xl font-black">Content <span class="gradient-text">Management</span></h1>
          <button onclick="openContentModal()" class="bg-gradient-to-r from-purple-500 to-pink-600 px-6 py-3 rounded-xl font-bold hover:shadow-xl transition-all">
            <i class="fas fa-plus mr-2"></i>Create New Content
          </button>
        </div>

        <!-- Content Tabs -->
        <div class="flex gap-4 mb-6 overflow-x-auto pb-2">
          <button onclick="filterContent('all')" id="filter-all" class="tab-button active px-6 py-3 rounded-xl font-semibold whitespace-nowrap">
            All Content
          </button>
          <button onclick="filterContent('Draft')" id="filter-Draft" class="tab-button bg-slate-800/50 hover:bg-slate-700/50 px-6 py-3 rounded-xl font-semibold whitespace-nowrap">
            <i class="fas fa-edit mr-2"></i>Drafts
          </button>
          <button onclick="filterContent('Pending')" id="filter-Pending" class="tab-button bg-slate-800/50 hover:bg-slate-700/50 px-6 py-3 rounded-xl font-semibold whitespace-nowrap">
            <i class="fas fa-clock mr-2"></i>Pending
          </button>
          <button onclick="filterContent('Published')" id="filter-Published" class="tab-button bg-slate-800/50 hover:bg-slate-700/50 px-6 py-3 rounded-xl font-semibold whitespace-nowrap">
            <i class="fas fa-check mr-2"></i>Published
          </button>
          <button onclick="filterContent('News')" id="filter-News" class="tab-button bg-slate-800/50 hover:bg-slate-700/50 px-6 py-3 rounded-xl font-semibold whitespace-nowrap">
            News
          </button>
          <button onclick="filterContent('Resources')" id="filter-Resources" class="tab-button bg-slate-800/50 hover:bg-slate-700/50 px-6 py-3 rounded-xl font-semibold whitespace-nowrap">
            Resources
          </button>
        </div>

        <!-- Content Grid -->
        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6" id="contentGrid"></div>
      </div>
    </div>

    <!-- Approval Queue Section -->
    <div id="approvalContent" class="hidden pt-24 pb-12 px-4 sm:px-6">
      <div class="max-w-7xl mx-auto">
        <div class="flex items-center justify-between mb-8">
          <div>
            <h1 class="text-4xl font-black">Approval <span class="gradient-text">Queue</span></h1>
            <p class="text-gray-400 mt-2">Review and approve content before publishing to News/Resources</p>
          </div>
        </div>

        <!-- Approval Grid -->
        <div class="grid md:grid-cols-2 gap-6" id="approvalGrid"></div>
      </div>
    </div>

    <!-- Published Content Section -->
    <div id="publishedContent" class="hidden pt-24 pb-12 px-4 sm:px-6">
      <div class="max-w-7xl mx-auto">
        <div class="flex items-center justify-between mb-8">
          <div>
            <h1 class="text-4xl font-black">Published <span class="gradient-text">Content</span></h1>
            <p class="text-gray-400 mt-2">Live content on News & Resources pages</p>
          </div>
          <button onclick="syncPublishedContent()" class="bg-gradient-to-r from-green-500 to-emerald-600 px-6 py-3 rounded-xl font-bold hover:shadow-xl transition-all">
            <i class="fas fa-sync-alt mr-2"></i>Sync to Public Pages
          </button>
        </div>

        <!-- Published Grid -->
        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6" id="publishedGrid"></div>
      </div>
    </div>
  </div>

  <!-- Content Modal -->
  <div id="contentModal" class="modal">
    <div class="glass rounded-3xl p-8 max-w-4xl w-full max-h-[90vh] overflow-y-auto my-8">
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-2xl font-black" id="contentModalTitle">Create New Content</h2>
        <button onclick="closeContentModal()" class="text-gray-400 hover:text-white">
          <i class="fas fa-times text-2xl"></i>
        </button>
      </div>
      <form id="contentForm" class="space-y-4">
        <input type="hidden" id="editContentId">
        
        <div class="grid md:grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-semibold mb-2">Title *</label>
            <input type="text" id="contentTitle" required class="w-full bg-slate-800/50 border border-slate-700 rounded-xl px-4 py-3 text-white">
          </div>
          
          <div>
            <label class="block text-sm font-semibold mb-2">Category *</label>
            <select id="contentCategory" required class="w-full bg-slate-800/50 border border-slate-700 rounded-xl px-4 py-3 text-white">
              <option value="News">News</option>
              <option value="Resources">Resources</option>
              <option value="Guides">Guides</option>
              <option value="Tutorial">Tutorial</option>
              <option value="Case Study">Case Study</option>
            </select>
          </div>
        </div>

        <div>
          <label class="block text-sm font-semibold mb-2">Short Description *</label>
          <textarea id="contentDescription" rows="2" required class="w-full bg-slate-800/50 border border-slate-700 rounded-xl px-4 py-3 text-white"></textarea>
        </div>

        <div>
          <label class="block text-sm font-semibold mb-2">Full Content *</label>
          <textarea id="contentBody" rows="8" required class="w-full bg-slate-800/50 border border-slate-700 rounded-xl px-4 py-3 text-white"></textarea>
        </div>

        <div class="grid md:grid-cols-3 gap-4">
          <div>
            <label class="block text-sm font-semibold mb-2">Author *</label>
            <input type="text" id="contentAuthor" required class="w-full bg-slate-800/50 border border-slate-700 rounded-xl px-4 py-3 text-white">
          </div>

          <div>
            <label class="block text-sm font-semibold mb-2">Publish Date *</label>
            <input type="date" id="contentDate" required class="w-full bg-slate-800/50 border border-slate-700 rounded-xl px-4 py-3 text-white">
          </div>

          <div>
            <label class="block text-sm font-semibold mb-2">Status *</label>
            <select id="contentStatus" required class="w-full bg-slate-800/50 border border-slate-700 rounded-xl px-4 py-3 text-white">
              <option value="Draft">Draft (Save for later)</option>
              <option value="Pending">Pending (Submit for approval)</option>
            </select>
          </div>
        </div>

        <div>
          <label class="block text-sm font-semibold mb-2">Featured Image URL</label>
          <input type="url" id="contentImage" placeholder="https://example.com/image.jpg" class="w-full bg-slate-800/50 border border-slate-700 rounded-xl px-4 py-3 text-white">
        </div>

        <div>
          <label class="block text-sm font-semibold mb-2">Tags (comma separated)</label>
          <input type="text" id="contentTags" placeholder="mining, technology, sustainability" class="w-full bg-slate-800/50 border border-slate-700 rounded-xl px-4 py-3 text-white">
        </div>

        <div class="bg-cyan-500/10 border border-cyan-500/30 rounded-xl p-4">
          <p class="text-sm text-cyan-400">
            <i class="fas fa-info-circle mr-2"></i>
            <strong>Publishing Workflow:</strong> Draft â†’ Submit for Approval â†’ Admin Reviews â†’ Published to News/Resources
          </p>
        </div>

        <div class="flex gap-3">
          <button type="submit" class="flex-1 bg-gradient-to-r from-purple-500 to-pink-600 px-6 py-3 rounded-xl font-bold">
            <i class="fas fa-save mr-2"></i>Save Content
          </button>
          <button type="button" onclick="closeContentModal()" class="px-6 py-3 bg-slate-700 hover:bg-slate-600 rounded-xl font-bold">
            Cancel
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- View Content Modal -->
  <div id="viewModal" class="modal">
    <div class="glass rounded-3xl p-8 max-w-4xl w-full max-h-[90vh] overflow-y-auto my-8">
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-2xl font-black" id="viewModalTitle">Content Preview</h2>
        <button onclick="closeViewModal()" class="text-gray-400 hover:text-white">
          <i class="fas fa-times text-2xl"></i>
        </button>
      </div>
      <div id="viewModalBody"></div>
    </div>
  </div>

  <script>
    // EmailJS Init
    emailjs.init('vIsuy4VXOAFCLwx2c');

    // Data Storage Keys
    const STORAGE_KEYS = {
      CONTENT: 'sesmine_admin_content',
      PUBLIC_NEWS: 'sesmine_public_news',
      PUBLIC_RESOURCES: 'sesmine_public_resources'
    };

    // Data
    let content = [];
    let charts = {};
    let currentFilter = 'all';

    const ADMIN_USERS = {
      'admin@sesmine.com': { password: 'admin123', name: 'Admin User', role: 'Super Admin' }
    };

    // Sample Content
    const sampleContent = [
      {
        id: 1,
        title: 'AI Revolution in Mining Industry 2026',
        category: 'News',
        description: 'Artificial Intelligence is transforming mining operations with unprecedented efficiency and safety improvements.',
        body: 'The mining industry is experiencing a technological revolution driven by AI and machine learning. From autonomous drilling to predictive maintenance, AI is reshaping every aspect of mining operations. This comprehensive analysis explores how leading mining companies are implementing AI solutions to improve safety, reduce costs, and increase productivity. Key areas include: autonomous vehicles, real-time monitoring systems, predictive analytics for equipment maintenance, and AI-powered exploration techniques.',
        author: 'Dr. Sarah Chen',
        date: '2026-01-05',
        status: 'Published',
        image: 'https://images.unsplash.com/photo-1485827404703-89b55fcc595e?w=800',
        tags: 'AI, mining, technology, automation',
        views: 1847,
        created: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000).toISOString(),
        publishedDate: new Date(Date.now() - 1 * 24 * 60 * 60 * 1000).toISOString()
      },
      {
        id: 2,
        title: 'Complete Cost Estimation Guide 2026',
        category: 'Resources',
        description: 'Comprehensive guide covering all aspects of mining project cost estimation with real-world examples.',
        body: 'Cost estimation is critical for mining project success. This detailed guide covers: parametric estimation methods, analogous estimation techniques, bottom-up estimation approaches, three-point estimation, and contingency planning. Includes downloadable templates, case studies from successful projects, and best practices from industry experts. Learn how to create accurate estimates that account for geological uncertainties, equipment costs, labor rates, and regulatory compliance.',
        author: 'Michael Rodriguez',
        date: '2026-01-04',
        status: 'Pending',
        image: 'https://images.unsplash.com/photo-1454165804606-c3d57bc86b40?w=800',
        tags: 'cost estimation, resources, guide, planning',
        views: 0,
        created: new Date(Date.now() - 1 * 24 * 60 * 60 * 1000).toISOString()
      },
      {
        id: 3,
        title: 'Sustainable Mining Practices Framework',
        category: 'Resources',
        description: 'Step-by-step framework for implementing sustainable and responsible mining operations.',
        body: 'Environmental sustainability is essential in modern mining. This framework covers: water management systems, waste reduction strategies, energy efficiency optimization, biodiversity protection protocols, community engagement best practices, and ESG reporting standards. Includes implementation checklists, ROI analysis tools, and success stories from mines that have achieved sustainability certifications.',
        author: 'Emma Thompson',
        date: '2026-01-03',
        status: 'Draft',
        image: 'https://images.unsplash.com/photo-1473341304170-971dccb5ac1e?w=800',
        tags: 'sustainability, ESG, environment, best practices',
        views: 0,
        created: new Date(Date.now() - 3 * 24 * 60 * 60 * 1000).toISOString()
      }
    ];

    // Initialize
    function init() {
      loadData();
      if (!checkSession()) {
        document.getElementById('loginScreen').classList.remove('hidden');
      }
    }

    // Load Data
    function loadData() {
      const stored = localStorage.getItem(STORAGE_KEYS.CONTENT);
      content = stored ? JSON.parse(stored) : sampleContent;
    }

    // Save Data
    function saveData() {
      localStorage.setItem(STORAGE_KEYS.CONTENT, JSON.stringify(content));
    }

    // Sync to Public Pages
    function syncPublishedContent() {
      const publishedContent = content.filter(c => c.status === 'Published');
      const news = publishedContent.filter(c => c.category === 'News');
      const resources = publishedContent.filter(c => c.category === 'Resources' || c.category === 'Guides' || c.category === 'Tutorial' || c.category === 'Case Study');
      
      localStorage.setItem(STORAGE_KEYS.PUBLIC_NEWS, JSON.stringify(news));
      localStorage.setItem(STORAGE_KEYS.PUBLIC_RESOURCES, JSON.stringify(resources));
      
      showNotification(`âœ… Synced ${news.length} news articles and ${resources.length} resources to public pages!`);
      
      // Trigger storage event for other tabs
      window.dispatchEvent(new Event('storage'));
    }

    // Auto-sync on publish
    function autoSync() {
      syncPublishedContent();
    }

    // Show Notification
    function showNotification(message, type = 'success') {
      const notification = document.createElement('div');
      notification.className = `notification glass ${type === 'success' ? 'border-green-500' : 'border-red-500'} border-2`;
      notification.innerHTML = `
        <i class="fas fa-${type === 'success' ? 'check-circle' : 'exclamation-circle'} mr-2"></i>
        ${message}
      `;
      document.body.appendChild(notification);
      setTimeout(() => notification.remove(), 4000);
    }

    // Check Session
    function checkSession() {
      const session = localStorage.getItem('adminSession');
      if (session) {
        const data = JSON.parse(session);
        if (Date.now() - data.timestamp < 24 * 60 * 60 * 1000) {
          showDashboard(data);
          return true;
        }
      }
      return false;
    }

    // Toggle Password
    function togglePasswordVisibility() {
      const input = document.getElementById('loginPassword');
      const icon = document.getElementById('toggleIcon');
      if (input.type === 'password') {
        input.type = 'text';
        icon.classList.replace('fa-eye', 'fa-eye-slash');
      } else {
        input.type = 'password';
        icon.classList.replace('fa-eye-slash', 'fa-eye');
      }
    }

    // Show Error
    function showError(message) {
      const errorDiv = document.getElementById('loginError');
      const errorMessage = document.getElementById('errorMessage');
      errorMessage.textContent = message;
      errorDiv.classList.remove('hidden');
      setTimeout(() => errorDiv.classList.add('hidden'), 5000);
    }

    // Login
    document.getElementById('loginForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const email = document.getElementById('loginEmail').value;
      const password = document.getElementById('loginPassword').value;
      const button = document.getElementById('loginButtonText');

      button.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Signing In...';

      setTimeout(() => {
        const user = ADMIN_USERS[email];
        
        if (user && user.password === password) {
          const sessionData = {
            email: email,
            name: user.name,
            role: user.role,
            timestamp: Date.now()
          };
          localStorage.setItem('adminSession', JSON.stringify(sessionData));
          showDashboard(sessionData);
        } else {
          showError('Invalid email or password');
          button.textContent = 'Sign In';
        }
      }, 1000);
    });

    // Show Dashboard
    function showDashboard(userData) {
      document.getElementById('loginScreen').classList.add('hidden');
      document.getElementById('dashboardScreen').classList.remove('hidden');
      
      document.getElementById('navAdminName').textContent = userData.name;
      
      updateTime();
      setInterval(updateTime, 1000);
      
      updateAllStats();
      updateBadges();
      loadRecentActivity();
      renderContent();
      renderApprovalQueue();
      renderPublished();
      
      setTimeout(createCharts, 100);
    }

    // Update Time
    function updateTime() {
      const now = new Date();
      const options = { 
        weekday: 'long', 
        year: 'numeric', 
        month: 'long', 
        day: 'numeric',
        hour: '2-digit',
        minute: '2-digit',
        second: '2-digit'
      };
      const timeEl = document.getElementById('currentTime');
      if (timeEl) {
        timeEl.textContent = now.toLocaleDateString('en-US', options);
      }
    }

    // Update All Stats
    function updateAllStats() {
      const draft = content.filter(c => c.status === 'Draft').length;
      const pending = content.filter(c => c.status === 'Pending').length;
      const published = content.filter(c => c.status === 'Published').length;
      const totalViews = content.reduce((sum, c) => sum + (c.views || 0), 0);
      
      document.getElementById('statTotal').textContent = content.length;
      document.getElementById('statDraft').textContent = draft;
      document.getElementById('statPending').textContent = pending;
      document.getElementById('statPublished').textContent = published;
      document.getElementById('statViews').textContent = totalViews.toLocaleString();
    }

    // Update Badges
    function updateBadges() {
      const pending = content.filter(c => c.status === 'Pending').length;
      const draft = content.filter(c => c.status === 'Draft').length;
      
      const approvalBadge = document.getElementById('approvalBadge');
      const contentBadge = document.getElementById('contentBadge');
      
      approvalBadge.textContent = pending;
      approvalBadge.style.display = pending > 0 ? 'flex' : 'none';
      
      contentBadge.textContent = draft;
      contentBadge.style.display = draft > 0 ? 'flex' : 'none';
    }

    // Load Recent Activity
    function loadRecentActivity() {
      const activities = [];
      
      content.slice(0, 5).forEach(c => {
        let icon, color, text;
        if (c.status === 'Published') {
          icon = 'check-circle';
          color = 'green';
          text = `Published: ${c.title}`;
        } else if (c.status === 'Pending') {
          icon = 'clock';
          color = 'orange';
          text = `Pending approval: ${c.title}`;
        } else {
          icon = 'edit';
          color = 'amber';
          text = `Draft created: ${c.title}`;
        }
        
        activities.push({
          icon, color, text,
          time: getTimeAgo(c.created)
        });
      });
      
      const container = document.getElementById('activityList');
      if (activities.length === 0) {
        container.innerHTML = '<div class="text-center text-gray-400 py-8">No recent activity</div>';
        return;
      }
      
      container.innerHTML = activities.map(activity => `
        <div class="flex items-start gap-4 p-4 bg-slate-800/30 rounded-xl hover:bg-slate-800/50 transition-all">
          <div class="w-10 h-10 bg-${activity.color}-500/20 rounded-lg flex items-center justify-center flex-shrink-0">
            <i class="fas fa-${activity.icon} text-${activity.color}-400"></i>
          </div>
          <div class="flex-1">
            <div class="text-sm">${activity.text}</div>
            <div class="text-xs text-gray-500 mt-1">${activity.time}</div>
          </div>
        </div>
      `).join('');
    }

    // Get Time Ago
    function getTimeAgo(dateString) {
      const date = new Date(dateString);
      const now = new Date();
      const seconds = Math.floor((now - date) / 1000);
      
      if (seconds < 60) return 'Just now';
      if (seconds < 3600) return Math.floor(seconds / 60) + ' minutes ago';
      if (seconds < 86400) return Math.floor(seconds / 3600) + ' hours ago';
      return Math.floor(seconds / 86400) + ' days ago';
    }

    // Create Charts
    function createCharts() {
      const activityCtx = document.getElementById('activityChart');
      if (activityCtx && !charts.activityChart) {
        charts.activityChart = new Chart(activityCtx, {
          type: 'line',
          data: {
            labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
            datasets: [{
              label: 'Published Content',
              data: [2, 4, 3, 5, 6, 4, 7],
              borderColor: '#06b6d4',
              backgroundColor: 'rgba(6, 182, 212, 0.1)',
              tension: 0.4,
              fill: true,
              borderWidth: 3
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: { legend: { labels: { color: '#fff' } } },
            scales: {
              y: { beginAtZero: true, grid: { color: 'rgba(255,255,255,0.1)' }, ticks: { color: '#94a3b8' } },
              x: { grid: { display: false }, ticks: { color: '#94a3b8' } }
            }
          }
        });
      }

      const statusCtx = document.getElementById('statusChart');
      if (statusCtx && !charts.statusChart) {
        const draft = content.filter(c => c.status === 'Draft').length;
        const pending = content.filter(c => c.status === 'Pending').length;
        const published = content.filter(c => c.status === 'Published').length;
        
        charts.statusChart = new Chart(statusCtx, {
          type: 'doughnut',
          data: {
            labels: ['Draft', 'Pending Approval', 'Published'],
            datasets: [{
              data: [draft, pending, published],
              backgroundColor: ['#f59e0b', '#f97316', '#22c55e'],
              borderWidth: 0
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: { 
              legend: { 
                position: 'bottom',
                labels: { color: '#fff', padding: 20 }
              }
            }
          }
        });
      }
    }

    // CONTENT MANAGEMENT
    function renderContent() {
      const grid = document.getElementById('contentGrid');
      if (!grid) return;
      
      let filtered = [...content];
      if (currentFilter !== 'all') {
        if (['Draft', 'Pending', 'Published'].includes(currentFilter)) {
          filtered = filtered.filter(c => c.status === currentFilter);
        } else {
          filtered = filtered.filter(c => c.category === currentFilter);
        }
      }
      
      if (filtered.length === 0) {
        grid.innerHTML = `
          <div class="glass rounded-2xl p-12 text-center col-span-3">
            <i class="fas fa-inbox text-6xl text-gray-600 mb-4"></i>
            <p class="text-gray-400">No content found</p>
          </div>
        `;
        return;
      }
      
      grid.innerHTML = filtered.map(item => `
        <div class="glass rounded-2xl overflow-hidden card-hover ${item.status === 'Pending' ? 'status-pending' : ''}">
          ${item.image ? `
            <div class="h-48 overflow-hidden">
              <img src="${item.image}" alt="${item.title}" class="w-full h-full object-cover" onerror="this.parentElement.style.display='none'">
            </div>
          ` : ''}
          <div class="p-6">
            <div class="flex items-start justify-between mb-4">
              <span class="px-3 py-1 rounded-full text-xs font-semibold bg-purple-500/20 text-purple-400">${item.category}</span>
              <span class="px-3 py-1 rounded-full text-xs font-semibold ${getStatusColor(item.status)}">${item.status}</span>
            </div>
            <h3 class="text-xl font-bold mb-2 line-clamp-2">${item.title}</h3>
            <p class="text-gray-400 text-sm mb-4 line-clamp-2">${item.description}</p>
            <div class="flex items-center justify-between text-xs text-gray-500 mb-4">
              <span><i class="fas fa-user mr-2"></i>${item.author}</span>
              <span><i class="fas fa-calendar mr-2"></i>${new Date(item.date).toLocaleDateString()}</span>
            </div>
            <div class="flex gap-2">
              <button onclick="viewContent(${item.id})" class="flex-1 bg-cyan-500/20 hover:bg-cyan-500/30 text-cyan-400 py-2 rounded-lg transition-all text-sm">
                <i class="fas fa-eye mr-1"></i>View
              </button>
              ${item.status !== 'Published' ? `
                <button onclick="editContent(${item.id})" class="flex-1 bg-purple-500/20 hover:bg-purple-500/30 text-purple-400 py-2 rounded-lg transition-all text-sm">
                  <i class="fas fa-edit mr-1"></i>Edit
                </button>
              ` : ''}
              <button onclick="deleteContent(${item.id})" class="flex-1 bg-red-500/20 hover:bg-red-500/30 text-red-400 py-2 rounded-lg transition-all text-sm">
                <i class="fas fa-trash mr-1"></i>Delete
              </button>
            </div>
          </div>
        </div>
      `).join('');
    }

    // Render Approval Queue
    function renderApprovalQueue() {
      const grid = document.getElementById('approvalGrid');
      if (!grid) return;
      
      const pending = content.filter(c => c.status === 'Pending');
      
      if (pending.length === 0) {
        grid.innerHTML = `
          <div class="glass rounded-2xl p-12 text-center col-span-2">
            <i class="fas fa-check-circle text-6xl text-gray-600 mb-4"></i>
            <p class="text-gray-400">No content pending approval</p>
          </div>
        `;
        return;
      }
      
      grid.innerHTML = pending.map(item => `
        <div class="glass rounded-2xl overflow-hidden status-pending">
          ${item.image ? `
            <div class="h-48 overflow-hidden">
              <img src="${item.image}" alt="${item.title}" class="w-full h-full object-cover" onerror="this.parentElement.style.display='none'">
            </div>
          ` : ''}
          <div class="p-6">
            <div class="flex items-start justify-between mb-4">
              <span class="px-3 py-1 rounded-full text-xs font-semibold bg-purple-500/20 text-purple-400">${item.category}</span>
              <span class="px-3 py-1 rounded-full text-xs font-semibold bg-orange-500/20 text-orange-400">
                <i class="fas fa-clock mr-1"></i>Pending Review
              </span>
            </div>
            <h3 class="text-xl font-bold mb-2">${item.title}</h3>
            <p class="text-gray-400 text-sm mb-4">${item.description}</p>
            <div class="flex items-center justify-between text-xs text-gray-500 mb-4">
              <span><i class="fas fa-user mr-2"></i>${item.author}</span>
              <span><i class="fas fa-calendar mr-2"></i>${new Date(item.date).toLocaleDateString()}</span>
            </div>
            <div class="flex gap-2">
              <button onclick="viewContent(${item.id})" class="flex-1 bg-cyan-500/20 hover:bg-cyan-500/30 text-cyan-400 py-2 rounded-lg transition-all text-sm">
                <i class="fas fa-eye mr-1"></i>Preview
              </button>
              <button onclick="approveContent(${item.id})" class="flex-1 bg-green-500/20 hover:bg-green-500/30 text-green-400 py-2 rounded-lg transition-all text-sm">
                <i class="fas fa-check mr-1"></i>Approve & Publish
              </button>
              <button onclick="rejectContent(${item.id})" class="flex-1 bg-red-500/20 hover:bg-red-500/30 text-red-400 py-2 rounded-lg transition-all text-sm">
                <i class="fas fa-times mr-1"></i>Reject
              </button>
            </div>
          </div>
        </div>
      `).join('');
    }

    // Render Published
    function renderPublished() {
      const grid = document.getElementById('publishedGrid');
      if (!grid) return;
      
      const published = content.filter(c => c.status === 'Published');
      
      if (published.length === 0) {
        grid.innerHTML = `
          <div class="glass rounded-2xl p-12 text-center col-span-3">
            <i class="fas fa-globe text-6xl text-gray-600 mb-4"></i>
            <p class="text-gray-400">No published content yet</p>
          </div>
        `;
        return;
      }
      
      grid.innerHTML = published.map(item => `
        <div class="glass rounded-2xl overflow-hidden card-hover">
          ${item.image ? `
            <div class="h-48 overflow-hidden">
              <img src="${item.image}" alt="${item.title}" class="w-full h-full object-cover" onerror="this.parentElement.style.display='none'">
            </div>
          ` : ''}
          <div class="p-6">
            <div class="flex items-start justify-between mb-4">
              <span class="px-3 py-1 rounded-full text-xs font-semibold bg-purple-500/20 text-purple-400">${item.category}</span>
              <span class="px-3 py-1 rounded-full text-xs font-semibold bg-green-500/20 text-green-400">
                <i class="fas fa-check-circle mr-1"></i>Live
              </span>
            </div>
            <h3 class="text-xl font-bold mb-2 line-clamp-2">${item.title}</h3>
            <p class="text-gray-400 text-sm mb-4 line-clamp-2">${item.description}</p>
            <div class="flex items-center justify-between text-xs text-gray-500 mb-4">
              <span><i class="fas fa-eye mr-2"></i>${item.views || 0} views</span>
              <span><i class="fas fa-calendar mr-2"></i>Published ${getTimeAgo(item.publishedDate || item.created)}</span>
            </div>
            <div class="flex gap-2">
              <button onclick="viewContent(${item.id})" class="flex-1 bg-cyan-500/20 hover:bg-cyan-500/30 text-cyan-400 py-2 rounded-lg transition-all text-sm">
                <i class="fas fa-eye mr-1"></i>View
              </button>
              <button onclick="unpublishContent(${item.id})" class="flex-1 bg-amber-500/20 hover:bg-amber-500/30 text-amber-400 py-2 rounded-lg transition-all text-sm">
                <i class="fas fa-undo mr-1"></i>Unpublish
              </button>
            </div>
          </div>
        </div>
      `).join('');
    }

    // Get Status Color
    function getStatusColor(status) {
      const colors = {
        'Draft': 'bg-amber-500/20 text-amber-400',
        'Pending': 'bg-orange-500/20 text-orange-400',
        'Published': 'bg-green-500/20 text-green-400'
      };
      return colors[status] || 'bg-gray-500/20 text-gray-400';
    }

    // Filter Content
    function filterContent(filter) {
      currentFilter = filter;
      document.querySelectorAll('.tab-button').forEach(btn => {
        btn.classList.remove('active');
        btn.classList.add('bg-slate-800/50', 'hover:bg-slate-700/50');
      });
      const activeBtn = document.getElementById('filter-' + filter);
      if (activeBtn) {
        activeBtn.classList.add('active');
        activeBtn.classList.remove('bg-slate-800/50', 'hover:bg-slate-700/50');
      }
      renderContent();
    }

    // Open Content Modal
    function openContentModal(id = null) {
      if (id) {
        const item = content.find(c => c.id === id);
        if (item) {
          document.getElementById('contentModalTitle').textContent = 'Edit Content';
          document.getElementById('editContentId').value = id;
          document.getElementById('contentTitle').value = item.title;
          document.getElementById('contentCategory').value = item.category;
          document.getElementById('contentDescription').value = item.description;
          document.getElementById('contentBody').value = item.body;
          document.getElementById('contentAuthor').value = item.author;
          document.getElementById('contentDate').value = item.date;
          document.getElementById('contentStatus').value = item.status;
          document.getElementById('contentImage').value = item.image || '';
          document.getElementById('contentTags').value = item.tags || '';
        }
      } else {
        document.getElementById('contentModalTitle').textContent = 'Create New Content';
        document.getElementById('contentForm').reset();
        document.getElementById('editContentId').value = '';
        document.getElementById('contentDate').valueAsDate = new Date();
      }
      document.getElementById('contentModal').classList.add('active');
    }

    function closeContentModal() {
      document.getElementById('contentModal').classList.remove('active');
    }

    function editContent(id) {
      openContentModal(id);
    }

    // View Content
    function viewContent(id) {
      const item = content.find(c => c.id === id);
      if (item) {
        document.getElementById('viewModalTitle').textContent = item.title;
        document.getElementById('viewModalBody').innerHTML = `
          <div class="space-y-4">
            ${item.image ? `<img src="${item.image}" alt="${item.title}" class="w-full h-64 object-cover rounded-xl mb-4" onerror="this.style.display='none'">` : ''}
            <div class="flex items-center gap-4 text-sm text-gray-400 flex-wrap">
              <span><i class="fas fa-user mr-2"></i>${item.author}</span>
              <span><i class="fas fa-calendar mr-2"></i>${new Date(item.date).toLocaleDateString()}</span>
              <span class="px-3 py-1 rounded-full text-xs font-semibold ${getStatusColor(item.status)}">${item.status}</span>
              <span class="px-3 py-1 rounded-full text-xs font-semibold bg-purple-500/20 text-purple-400">${item.category}</span>
            </div>
            <div class="prose prose-invert max-w-none">
              <p class="text-lg text-gray-300 leading-relaxed">${item.description}</p>
              <div class="mt-4 text-gray-400 leading-relaxed">${item.body}</div>
            </div>
            ${item.tags ? `
              <div class="flex flex-wrap gap-2 mt-4">
                ${item.tags.split(',').map(tag => `<span class="px-3 py-1 bg-cyan-500/20 text-cyan-400 rounded-full text-xs">${tag.trim()}</span>`).join('')}
              </div>
            ` : ''}
          </div>
        `;
        document.getElementById('viewModal').classList.add('active');
      }
    }

    function closeViewModal() {
      document.getElementById('viewModal').classList.remove('active');
    }

    // Approve Content
    function approveContent(id) {
      if (confirm('âœ… Approve and publish this content to News/Resources page?')) {
        const item = content.find(c => c.id === id);
        if (item) {
          item.status = 'Published';
          item.publishedDate = new Date().toISOString();
          saveData();
          autoSync();
          renderContent();
          renderApprovalQueue();
          renderPublished();
          updateAllStats();
          updateBadges();
          updateCharts();
          loadRecentActivity();
          showNotification(`âœ… "${item.title}" has been published to ${item.category} page!`);
        }
      }
    }

    // Reject Content
    function rejectContent(id) {
      if (confirm('âš ï¸ Reject this content? It will be moved back to Draft.')) {
        const item = content.find(c => c.id === id);
        if (item) {
          item.status = 'Draft';
          saveData();
          renderContent();
          renderApprovalQueue();
          updateAllStats();
          updateBadges();
          updateCharts();
          showNotification(`Content "${item.title}" rejected and moved to Draft.`);
        }
      }
    }

    // Unpublish Content
    function unpublishContent(id) {
      if (confirm('âš ï¸ Unpublish this content? It will be removed from public pages.')) {
        const item = content.find(c => c.id === id);
        if (item) {
          item.status = 'Draft';
          saveData();
          autoSync();
          renderContent();
          renderPublished();
          updateAllStats();
          updateBadges();
          updateCharts();
          showNotification(`Content "${item.title}" unpublished.`);
        }
      }
    }

    // Delete Content
    function deleteContent(id) {
      if (confirm('âš ï¸ Permanently delete this content?')) {
        content = content.filter(c => c.id !== id);
        saveData();
        autoSync();
        renderContent();
        renderApprovalQueue();
        renderPublished();
        updateAllStats();
        updateBadges();
        updateCharts();
        showNotification('Content deleted successfully!');
      }
    }

    // Content Form Submit
    document.getElementById('contentForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const editId = document.getElementById('editContentId').value;
      const formData = {
        title: document.getElementById('contentTitle').value,
        category: document.getElementById('contentCategory').value,
        description: document.getElementById('contentDescription').value,
        body: document.getElementById('contentBody').value,
        author: document.getElementById('contentAuthor').value,
        date: document.getElementById('contentDate').value,
        status: document.getElementById('contentStatus').value,
        image: document.getElementById('contentImage').value,
        tags: document.getElementById('contentTags').value,
        views: 0
      };
      
      if (editId) {
        const index = content.findIndex(c => c.id === parseInt(editId));
        if (index !== -1) {
          content[index] = { ...content[index], ...formData };
          showNotification('Content updated successfully!');
        }
      } else {
        const newContent = {
          id: content.length > 0 ? Math.max(...content.map(c => c.id)) + 1 : 1,
            ...formData,
            created: new Date().toISOString()
          };
          content.push(newContent);
          showNotification('Content created successfully!');
        }
        
        saveData();
        renderContent();
        renderApprovalQueue();
        renderPublished();
        updateAllStats();
        updateBadges();
        updateCharts();
        loadRecentActivity();
        closeContentModal();
      });

      // Update Charts
      function updateCharts() {
        if (charts.statusChart) {
          const draft = content.filter(c => c.status === 'Draft').length;
          const pending = content.filter(c => c.status === 'Pending').length;
          const published = content.filter(c => c.status === 'Published').length;
          
          charts.statusChart.data.datasets[0].data = [draft, pending, published];
          charts.statusChart.update();
        }
      }

      // Show Section
      function showSection(section) {
        ['dashboardContent', 'contentContent', 'approvalContent', 'publishedContent'].forEach(id => {
          const el = document.getElementById(id);
          if (el) el.classList.add('hidden');
        });
        
        const sectionEl = document.getElementById(section + 'Content');
        if (sectionEl) sectionEl.classList.remove('hidden');
        
        document.querySelectorAll('.nav-link').forEach(link => {
          link.classList.remove('text-cyan-400', 'font-semibold');
          link.classList.add('text-gray-400');
        });
        
        const activeLink = document.getElementById('nav-' + section);
        if (activeLink) {
          activeLink.classList.add('text-cyan-400', 'font-semibold');
          activeLink.classList.remove('text-gray-400');
        }
      }

      // Logout
      function handleLogout() {
        if (confirm('âš ï¸ Are you sure you want to logout?')) {
          localStorage.removeItem('adminSession');
          Object.keys(charts).forEach(key => {
            if (charts[key]) charts[key].destroy();
          });
          charts = {};
          location.reload();
        }
      }

      // Modal Close on Outside Click
      window.addEventListener('click', function(e) {
        if (e.target.classList.contains('modal')) {
          e.target.classList.remove('active');
        }
      });

      // Keyboard Shortcuts
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
          document.querySelectorAll('.modal').forEach(modal => {
            modal.classList.remove('active');
          });
        }
      });

      // Initialize
      init();
    </script>
  </body>
  </html>
